{
    "description": "<p>利姆路是隻可愛的始萊姆，雖然是它只是隻始萊姆，但它統領著森林中的魔物們。自古以來，魔物們最大的威脅莫過於人類的殺戮，利姆路為了保護它所管理的魔物們，它決定讓魔物們在村莊四周蓋上城牆，但是在它領導的眾多魔物村莊中，僅有部份村莊生產建造城牆所需的材料，因此其他村莊需要向這些村莊下訂這些材料。經過一年汲汲營營的建造，利姆路的辦公桌上積滿了來自各個村莊下訂建材的訂單，請你寫一個程式幫助它統整這些訂單。</p><p>在這題中，你僅需要完成程式的特定函式，在這個函式中，你會拿到<strong>由訂單組成的 linked-list</strong>，其中每筆訂單都會包含以下資訊：訂單的編號、下定的村莊、下定的建材編號以及數量。請注意：<strong>建材數量的資訊被包裝在 union 中</strong>，你必須根據建材編號讀取特定的欄位。你要實做的函式需要<strong>替每個村莊收集屬於它的訂單</strong>，並將它們串接成<strong>獨立的 linked-list</strong>，其中的訂單須按照<strong>訂單編號由少至多</strong>進行排序，並且，請替每個村莊<strong>計算過去這年它共花了多少錢</strong>購買建材（不同建材的單價可以在 loader code 中找到）。最後，為了簡化之後的查詢速度，請<strong>將村莊按照名稱排列</strong>。</p><hr><p>Rimuru is a cute slime who was killed by a random murder in his previous life, now he becomes the leader of the monsters live in the forest. To help the monsters prevent threads from the human world, he plans to make monsters build great walls around their villages. Since there are lots of villages in his monster kingdom, and only several of them are able to supply the building parts, they must trade those ingredients between the villages. After a year went through, the orders between villages are piled up like a mountain, please, help him to unify the orders.</p><p>In the following program, you will get <strong>several orders constructed as a linked-list</strong>, each order contains following things: order id, consumer of the order, the ingredient id and the amount of the ingredient. Please notice that <strong>the amount of the ingredient are packed in an union</strong>, you have to retrieve it from the specific member depends on the ingredient id. For each village, your program should not only <strong>gather the orders belongs to it</strong>, <strong>reconstruct them into an independent linked-list</strong>, <strong>sort the orders in ascending order by the order id</strong>, but also <strong>calculate the total cost</strong> of all orders (the unit cost of each ingredient can be found in the loader program). Finally, your program should <strong>sort the result list of villages via their name</strong>.</p><p><img src=\"https://steamuserimages-a.akamaihd.net/ugc/947342913895300025/7FC9DECBD7B41332CD3D264AA6B07A4BD8674D2C/\"></p>",
    "inputFormat": "輸入的第一行有兩個整數：V 跟 O，分別代表村莊的數量跟訂單的總筆數，接著有 V 行村莊的名字，剩下的 O 行為訂單的內容，訂單內容為以下格式：「訂單編號:建材編號/建材數量-下訂村莊」。\r\n\r\n限制：\r\n1. 1 <= V <= 75\r\n2. 1 <= O <= 1024\r\n3. 1 <= 建材數量 <= 1024\r\n4. 村莊名稱 < 16\r\n5. 訂單編號是一個 16 進位的字串，長度為 8\r\n\r\nThe first line contains two integers V, O that indicates the number of villages and orders, the next V lines are the village names. The rest of O lines are the orders which are in the format \"order_id:integration_id/amount-consumer\", each order occupies a line.\r\n\r\nrestrictions:\r\n1. 1 <= V <= 75\r\n2. 1 <= O <= 1024\r\n3. 1 <= amount <= 1024\r\n4. length of village name < 16\r\n5. order id is a hex string with length 8",
    "outputFormat": "程式須輸出每個村莊的名、它一年來的建材費用以及排序後，屬於該村莊的訂單的編號。\r\n\r\nEach village and its total cost to get the ingredients followed by the id of the orders belong to the village, the output ids should be sorted in ascending order.",
    "level": "Hard",
    "chapter": {
        "type": "Exam",
        "index": "final-2021"
    },
    "tags": [
        "Pointers",
        "Struct",
        "Union",
        "String"
    ],
    "hint": "請仔細閱讀 loader code，或許你會發現可以偷吃步的地方（？。  Read the loader code carefully, you may find points to use tricks (^ ^).",
    "timeLimit": 1,
    "memLimit": 5000,
    "coinReward": 0,
    "loaderCode": "#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n\r\n#define ORDER_ID_LEN 8\r\n#define MAX_VILLAGE_NAME_LEN 15\r\n\r\ntypedef struct order_s {\r\n\tstruct order_s *next;\r\n\tchar order_id[ORDER_ID_LEN + 1];\r\n\tchar consumer[MAX_VILLAGE_NAME_LEN + 1];\r\n\tenum {\r\n\t\tINGRED_A = 1,\r\n\t\tINGRED_B,\r\n\t\tINGRED_C,\r\n\t} ingredient_id;\r\n\tunion {\r\n\t\tchar ing_a[8];\r\n\t\tlong ing_b;\r\n\t\tdouble ing_c;\r\n\t} amount;\r\n} order_t;\r\n\r\ntypedef struct village_s {\r\n\tchar name[MAX_VILLAGE_NAME_LEN + 1];\r\n\tunsigned long total_cost;\r\n\torder_t *order_list;\r\n} village_t;\r\n\r\nstatic const long unit_costs[] = {\r\n\t[INGRED_A] = 256,\r\n\t[INGRED_B] = 512,\r\n\t[INGRED_C] = 1024,\r\n};\r\n\r\nstatic village_t *init_village_array(int v_cnt);\r\nstatic order_t *init_order_list(int o_cnt);\r\nstatic void unify_orders(village_t *vills, int v_cnt, order_t *orders);\r\nstatic void print_result(village_t *vills, int v_cnt);\r\n\r\nint main()\r\n{\r\n\tint village_cnt, order_cnt;\r\n\tscanf(\"%d%d\", &village_cnt, &order_cnt);\r\n\tvillage_t *villages = init_village_array(village_cnt);\r\n\tif (!villages) {\r\n\t\tgoto init_village_failed;\r\n    }\r\n\torder_t *orders = init_order_list(order_cnt);\r\n\tif (!orders)  {\r\n\t\tgoto init_order_failed;\r\n    }\r\n\tunify_orders(villages, village_cnt, orders);\r\n\tprint_result(villages, village_cnt);\r\n\tfree(orders);\r\n\r\ninit_order_failed:\r\n\tfree(villages);\r\n\r\ninit_village_failed:\r\n\treturn 0;\r\n}\r\n\r\nstatic village_t *init_village_array(int v_cnt)\r\n{\r\n\tvillage_t *villages = malloc(sizeof(village_t) * v_cnt);\r\n\tif (!villages) { // Ran out of memory\r\n\t\treturn NULL;\r\n    }\r\n\tfor (int i = 0; i < v_cnt; i++) {\r\n\t\tscanf(\"%s\", villages[i].name);\r\n    }\r\n\treturn villages;\r\n}\r\n\r\nstatic order_t *init_order_list(int o_cnt)\r\n{\r\n\torder_t *orders = malloc(sizeof(order_t) * o_cnt);\r\n\tif (!orders) { // Ran out of memory\r\n\t\treturn NULL;\r\n    }\r\n\tfor (int i = 0; i < o_cnt; i++) {\r\n\t\t// Read the content of order\r\n\t\t// the term %[^c] will use 'c' as delimiter while scanning the input\r\n\t\tscanf(\" %[^:]:%u/%[^-]-%s\",\r\n\t\t\t\torders[i].order_id,\r\n\t\t\t\t&orders[i].ingredient_id,\r\n\t\t\t\torders[i].amount.ing_a,\r\n\t\t\t\torders[i].consumer);\r\n\t\t\r\n\t\tswitch (orders[i].ingredient_id) {\r\n\t\t\tcase INGRED_B:\r\n\t\t\t\torders[i].amount.ing_b = atol(orders[i].amount.ing_a);\r\n\t\t\t\tbreak;\r\n\t\t\tcase INGRED_C:\r\n\t\t\t\torders[i].amount.ing_c = atof(orders[i].amount.ing_a);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t// Construct orders into linked-list\r\n\t\tif (i) {\r\n\t\t\torders[i - 1].next = orders + i;\r\n        }\r\n\t}\r\n\t// End the linked-list\r\n\torders[o_cnt - 1].next = NULL;\r\n\treturn orders;\r\n}\r\n\r\nstatic void print_result(village_t *vills, int v_cnt)\r\n{\r\n\tfor (int i = 0; i < v_cnt; i++) {\r\n\t\tprintf(\"%s %ld\\n  ->\", vills[i].name, vills[i].total_cost);\r\n\t\tfor (order_t *optr = vills[i].order_list; optr; optr = optr->next) {\r\n\t\t\tprintf(\" %s\", optr->order_id);\r\n        }\r\n\t\tprintf(\"\\n\");\r\n\t}\r\n}",
    "templateCode": "static void unify_orders(village_t *vills, int v_cnt, order_t *orders)\r\n{\r\n\r\n}\r\n",
    "title": "[20 Points] Let's Build Great Great Walls",
    "date": "2022-01-07T03:18:29.955Z",
    "samples": [
        {
            "inputData": "3 15\nGuanmiao\nSinsing\nTaoyuan\n79B3801D:3/59-Guanmiao\n48D32269:2/834-Guanmiao\n3A699371:3/249-Taoyuan\n3C52083B:1/337-Guanmiao\n6916A3F4:2/299-Taoyuan\n753181AF:2/84-Taoyuan\n158C8543:1/260-Guanmiao\n4C9470D9:3/624-Guanmiao\n76FDD0A1:2/723-Taoyuan\n34C1A646:1/788-Sinsing\n49C2EB29:1/772-Sinsing\n657D29BB:1/746-Taoyuan\n24335A5C:3/940-Taoyuan\n526BB92A:3/171-Guanmiao\n6761B64C:3/117-Taoyuan\n",
            "outputData": "Guanmiao 1454336\n  -> 158C8543 3C52083B 48D32269 4C9470D9 526BB92A 79B3801D\nSinsing 399360\n  -> 34C1A646 49C2EB29\nTaoyuan 2094592\n  -> 24335A5C 3A699371 657D29BB 6761B64C 6916A3F4 753181AF 76FDD0A1\n"
        },
        {
            "inputData": "4 18\nYujing\nYanshuei\nSinsing\nGangshan\n059D0501:2/441-Sinsing\n362B46E0:3/992-Sinsing\n34713753:2/167-Sinsing\n1C1E24ED:3/679-Yanshuei\n6504A3FD:1/487-Yujing\n598BD3F5:1/491-Sinsing\n6F8037D0:2/725-Yujing\n28B56E0C:3/891-Yanshuei\n3931CEF1:1/109-Yanshuei\n39B15E23:2/789-Sinsing\n572EC1A6:2/2-Yujing\n5137318F:2/458-Yujing\n12117749:2/701-Sinsing\n0D23AF31:2/821-Yanshuei\n2B897B63:3/462-Yujing\n19A04B37:2/126-Yujing\n50005E7A:3/1019-Yanshuei\n44AA8935:1/533-Gangshan\n",
            "outputData": "Gangshan 136448\n  -> 44AA8935\nSinsing 2215680\n  -> 059D0501 12117749 34713753 362B46E0 39B15E23 598BD3F5\nYanshuei 3099392\n  -> 0D23AF31 1C1E24ED 28B56E0C 3931CEF1 50005E7A\nYujing 1268992\n  -> 19A04B37 2B897B63 5137318F 572EC1A6 6504A3FD 6F8037D0\n"
        },
        {
            "inputData": "5 20\nSouth\nSinshih\nDanei\nDaliao\nHunei\n166C47E2:1/245-Sinshih\n7375D5C3:2/553-South\n12B62880:2/762-South\n58C3A4C6:1/403-Daliao\n37B7F642:3/38-Sinshih\n44369036:2/338-Daliao\n052D5D75:1/626-Sinshih\n2DACD55A:3/245-Danei\n75F41330:1/350-Sinshih\n6EE8A654:2/269-Daliao\n2A0633F4:3/371-South\n0CA3ECFD:2/970-Hunei\n0380EBFD:2/778-Hunei\n31EC81E4:1/366-Danei\n60BCEDD1:1/647-Danei\n7C8F0D3E:3/105-Danei\n05B5E563:1/355-Sinshih\n1987954B:2/653-Danei\n50C09674:1/506-Danei\n52654703:3/689-Danei\n",
            "outputData": "Daliao 413952\n  -> 44369036 58C3A4C6 6EE8A654\nDanei 1787136\n  -> 1987954B 2DACD55A 31EC81E4 50C09674 52654703 60BCEDD1 7C8F0D3E\nHunei 894976\n  -> 0380EBFD 0CA3ECFD\nSinshih 442368\n  -> 052D5D75 05B5E563 166C47E2 37B7F642 75F41330\nSouth 1053184\n  -> 12B62880 2A0633F4 7375D5C3\n"
        },
        {
            "inputData": "7 25\nAnnan\nZuojhen\nNanhua\nRiver\nDaliao\nAlian\nMaolin\n1A299881:3/197-River\n229EC19C:1/1021-Zuojhen\n46BA7EA1:3/618-Annan\n402C8159:3/319-River\n4AFA3035:2/551-Maolin\n07C76667:3/191-River\n1F5F8051:3/589-Daliao\n16609029:2/282-Daliao\n690461E6:1/22-Alian\n0C16D905:3/145-Maolin\n0F046D3F:1/133-Maolin\n0EDDACF7:2/652-Alian\n2416050E:3/401-Zuojhen\n72A828B7:1/566-Nanhua\n0F34EE9E:3/486-Nanhua\n21A00A47:1/883-River\n412F50DC:2/945-Alian\n12091799:3/393-Alian\n688A9F39:1/882-Annan\n7BC3E7D0:1/349-Annan\n2143B6AD:3/84-Daliao\n4E385D3A:2/109-Zuojhen\n1BD4570B:3/673-Annan\n0CE41551:1/384-Nanhua\n4F1BFD9A:1/16-Alian\n",
            "outputData": "Alian 1229824\n  -> 0EDDACF7 12091799 412F50DC 4F1BFD9A 690461E6\nAnnan 1637120\n  -> 1BD4570B 46BA7EA1 688A9F39 7BC3E7D0\nDaliao 833536\n  -> 16609029 1F5F8051 2143B6AD\nMaolin 464640\n  -> 0C16D905 0F046D3F 4AFA3035\nNanhua 740864\n  -> 0CE41551 0F34EE9E 72A828B7\nRiver 950016\n  -> 07C76667 1A299881 21A00A47 402C8159\nZuojhen 727808\n  -> 229EC19C 2416050E 4E385D3A\n"
        }
    ],
    "id": "urERgCk0xUCz"
}