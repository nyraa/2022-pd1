{
    "description": "<p>你知道股市是怎麼運作的嗎？股票市場上隨時都有人在進行交易，一下子有人要買一張台積電 (2330)，一下子有人要賣兩張長榮 (2603)，如果放任所有要交易股票的人在交易所的大廳比大聲的話，場面將會混亂不堪。因此，股票市場為了要維持有秩序的交易，有了以下的安排：</p><ol><li><p>所有交易都必須要寫在單子上拿給營業員，上面必須記載你的<strong>交易標的（要交易哪支股票）</strong>、<strong>是買方還是賣方</strong>、<strong>委託價（要交易在多少金額）</strong>、<strong>委託量（要交易多少張股票）</strong>。</p></li><li><p>營業員收到單子後，首先看你是要<strong>交易哪一個標的</strong>。例如：你要交易台積電。</p></li><li><p>確定標的後，再看你<strong>是買方還是賣方</strong>。例如：你要買台積電。</p></li><li><p>接著拿著你的單子和其它已經存在於市場上的委託比對，開始逐張撮合交易。</p><ul><li><p>如果現在收到的這張單子是<strong>要買股票</strong>，那就<strong>在賣方隊伍裡看看</strong>有沒有人要賣的價格<strong>等於或低於</strong>這張單子的價格。如果有的話，<strong>由價格最低者開始往上成交</strong>，直到交易量<strong>滿足委託量</strong>，或是價格<strong>高於委託價為止</strong>。例如：你出價要買三張 634 元的台積電，而賣方隊伍裡有三個人，分別要賣 632, 634, 636 元的台積電，那麼你會買到一張 632 元的台積電，和一張 634 元的台積電，剩下一張則還沒有成交，需要放進買方隊伍。</p></li><li><p>如果現在收到的這張單子是<strong>要賣股票</strong>，那就<strong>在買方隊伍裡看看</strong>有沒有人要買的價格<strong>等於或高於</strong>這張單子的價格。如果有的話，<strong>由價格最高者開始往下成交</strong>，直到交易量<strong>滿足委託量</strong>，或是價格<strong>低於委託價</strong>為止。</p></li><li><p>如果上述步驟無法滿足委託量，就把沒有辦法成交的量塞到買方/賣方隊伍中<strong>該價格的尾端</strong>，等待後續的撮合。</p></li></ul></li></ol><p>你可以手動撮合範例測資 1 來理解整個交易過程。</p><p></p><p>給定你某一天的股市交易委託記錄，請你計算當天各家股票的交易資訊，包含：</p><ul><li><p><strong>交易量</strong>: 該股票總共有幾張成交</p></li><li><p><strong>開盤價</strong>: 當天第一次成交的價格</p></li><li><p><strong>收盤價</strong>: 當天最後一次成交的價格</p></li><li><p><strong>最高價</strong>: 當天所有成交價格中最高的價格</p></li><li><p><strong>最低價</strong>: 當天所有成交價格中最低的價格</p></li></ul><p></p><p>Do you know how does the stock market work? In the stock market, there are always many people trading their shares. While someone want to buy a unit of TSM (2330), another one want to sell two units of EGMD (2603) in the meantime. it is natural that everybody want to be the first one to submit the order, and it is not a good idea to let people fight over who go first at the stock exchange. In order to maintain a peaceful stock market, there are some rules of the stock trading process:</p><ol><li><p>One must provide their order information to the agent. The order information includes: <strong>trading target</strong>, <strong>buy or sell</strong>, <strong>order price</strong>, and <strong>order amount (the amount of shares)</strong>.</p></li><li><p>Once the agent receive an order, it first checks for the <strong>trading target</strong>. For example: one want to trade 2330.</p></li><li><p>After the trading target is confirmed, the agent then checks <strong>whether the order is an order to buy or an order to sell</strong>. For example: one want to buy 2330.</p></li><li><p>After the target and the action are both confirm, the agent starts to transact the order.</p><ul><li><p>If the current order is an order to <strong>buy stock</strong>, the agent <strong>checks out the sell queue</strong> to see whether there are any pending order whose order price is <strong>equal to or lower than</strong> the order price of the current order. If yes, <strong>the pending orders with the lower order price will be transacted earlier</strong>. The transaction keeps going on until <strong>the current order amount is fulfilled</strong> or <strong>the lowset order price of the remaining pending orders is higher than the current order price</strong>. For example: one want to buy 3 units of 2330 at $634, and there are 3 people want to sell 1 unit of 2330 at $632, $634, $636, respectively. At this point, the 2 transaction will be made. The buyer will get 1 unit of 2330 at $632, and 1 unit of 2330 at $634. The remaining 1 unit is not transacted, and need to be put into the buy queue.</p></li><li><p>If the current order is an order to <strong>sell stock</strong>, the agent <strong>checks out the buy queue</strong> to see whether there are any pending order whose order price is <strong>equal to or higher than</strong> the order price of the current order. If yes, <strong>the pending orders with the higher order price will be transacted earlier</strong>. The transaction keeps going on until <strong>the current order amount is fulfilled</strong> or <strong>the highest order price of the remaining pending orders is lower than the current order price</strong>.</p></li><li><p>If there are no more pending order can be transacted but the current order amount is still not fulfilled, the remaining amount should be put to <strong>the end of the buy queue / sell queue for that order price</strong>.</p></li></ul></li></ol><p>You can try to process the example 1 manually to help you understand the rules.</p><p></p><p>Now, given an stock market order record, please calculate the trade summary of each trading target, including:</p><ul><li><p><strong>trade volumn</strong>: how many unit of shares are transacted</p></li><li><p><strong>opening price</strong>: the trade price of the first transaction</p></li><li><p><strong>closing price</strong>: the trade price of the final transaction</p></li><li><p><strong>highest price</strong>: the highest trade price amoung all the transaction</p></li><li><p><strong>lowset price</strong>: the lowset trade price amoung all the transaction</p></li></ul>",
    "inputFormat": "共有若干行輸入，每一行有四個資訊，由空白鍵分開，分別是：\r\n* 股票代號（四位整數）\r\n* 買或賣（BUY / SELL）\r\n* 委託價格\r\n* 委託張數\r\n可能出現的股票代號總共有 50 間。\r\n\r\nThere are multiple lines of input. Each line contains 4 information, separated by a space:\r\n* Stock id\r\n* Buy or sell (BUY / SELL)\r\n* Order price\r\n* Order amount\r\n\r\nThere are 50 different trading target in the market.",
    "outputFormat": "當日個股的交易統計量。\r\n\r\nThe trade summary.",
    "level": "Hard",
    "chapter": {
        "type": "Exam",
        "index": "final-2022"
    },
    "tags": [
        "Function",
        "String",
        "Pointers",
        "Struct"
    ],
    "hint": "你可以用優先佇列 (priority queue) 來儲存等候撮合的委託單。 You should maintain a priority queue to store your pending orders.",
    "timeLimit": 5,
    "memLimit": 8192,
    "coinReward": 0,
    "loaderCode": "#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n#define MARKET_SIZE 50\r\n\r\ntypedef enum\r\n{\r\n    BUY,\r\n    SELL\r\n} action_type;\r\n\r\ntypedef struct _order\r\n{\r\n    char stock_id[5];\r\n    action_type action;\r\n    float price;\r\n    int amount;\r\n    struct _order *next;\r\n} order;\r\n\r\ntypedef struct\r\n{\r\n    char stock_id[5];\r\n    int trading_volumn;\r\n    float opening_price;\r\n    float closing_price;\r\n    float highest_price;\r\n    float lowest_price;\r\n    order *buy_orders;\r\n    order *sell_orders;\r\n} subject;\r\n\r\nsubject market[MARKET_SIZE];\r\n\r\nvoid make_order(order *new_order);\r\n\r\nint cmp(const void *a, const void *b)\r\n{\r\n    subject *subjectA = (subject *)a;\r\n    subject *subjectB = (subject *)b;\r\n\r\n    return (subjectB->trading_volumn - subjectA->trading_volumn);\r\n}\r\n\r\nvoid print_price(float price){\r\n    if(price < 50) printf(\"  %6.2f\", price);\r\n    else if(price < 500) printf(\"  %6.1f\", price);\r\n    else printf(\"  %6.0f\", price);\r\n}\r\n\r\nint main()\r\n{\r\n    char buffer[30], target[5], action[5];\r\n    float price;\r\n    int amount;\r\n\r\n    while (fgets(buffer, 30, stdin) != NULL)\r\n    {\r\n        if(buffer[0] == '\\n') break;\r\n        sscanf(buffer, \"%s %s %f %d\\n\", target, action, &price, &amount);\r\n\r\n        order *new_order = (order *)malloc(sizeof(order));\r\n\r\n        strcpy(new_order->stock_id, target);\r\n        new_order->action = strcmp(action, \"BUY\") ? SELL : BUY;\r\n        new_order->price = price;\r\n        new_order->amount = amount;\r\n        new_order->next = NULL;\r\n\r\n        make_order(new_order);\r\n    }\r\n\r\n    qsort(market, MARKET_SIZE, sizeof(subject), cmp);\r\n\r\n    printf(\"stock_id  volumn    open   close    high     low\\n\");\r\n    for (int i = 0; i < MARKET_SIZE && market[i].stock_id[0] != '\\0'; ++i)\r\n    {\r\n        printf(\"%s      %6d\", market[i].stock_id ,market[i].trading_volumn);\r\n        print_price(market[i].opening_price);\r\n        print_price(market[i].closing_price);\r\n        print_price(market[i].highest_price);\r\n        print_price(market[i].lowest_price);\r\n        printf(\"\\n\");\r\n    }\r\n\r\n    return 0;\r\n}",
    "templateCode": "void make_order(order *new_order){\r\n\r\n}",
    "title": "[15 Points] Stock Trading",
    "date": "2022-01-08T19:12:13.347Z",
    "samples": [
        {
            "inputData": "2330 BUY 634 1\n2330 SELL 634 1\n2330 BUY 634 2\n2330 BUY 635 3\n2330 SELL 638 10\n2330 SELL 637 5\n2330 SELL 633 7\n2330 BUY 634 4\n2330 BUY 640 20\n2330 SELL 630 6",
            "outputData": "stock_id  volumn    open   close    high     low\n2330          29     634     634     640     633\n"
        },
        {
            "inputData": "2603 BUY 141 6\n2303 BUY 63.7 4\n2603 BUY 145 4\n2603 SELL 137.5 5\n2330 SELL 610 1\n2303 BUY 61.6 6\n2603 SELL 142.5 7\n2303 SELL 63.6 1\n2303 SELL 58.6 55\n2330 BUY 636 10",
            "outputData": "stock_id  volumn    open   close    high     low\n2303          10    63.7    61.6    63.7    61.6\n2603           5   145.0   141.0   145.0   141.0\n2330           1     610     610     610     610\n"
        },
        {
            "inputData": "2317 SELL 109 8\n2317 BUY 109.5 6\n2303 BUY 62.6 9\n2303 BUY 66.1 7\n2317 BUY 109.5 10\n0050 SELL 143 8\n0050 BUY 146 8\n0050 BUY 145.5 5\n2603 BUY 144.5 4\n2317 BUY 104 9\n0050 BUY 147 3\n2317 SELL 100 9\n2603 SELL 135 59\n2317 SELL 99.3 9\n2303 SELL 61.6 43\n0050 BUY 151.5 9\n2603 SELL 143 5\n2303 BUY 64.2 9\n2317 BUY 105 8\n0050 BUY 147 3\n0050 SELL 150.5 8\n0050 BUY 149 49\n0050 SELL 144.5 4\n2303 SELL 64 10\n2303 SELL 62 8\n2317 SELL 98.7 6\n0050 SELL 145.5 6\n0050 SELL 143.5 25\n0050 SELL 147 2\n2603 BUY 147 9",
            "outputData": "stock_id  volumn    open   close    high     low\n0050          53   143.0   149.0   151.5   143.0\n2317          32   109.0   105.0   109.5    99.3\n2303          25    66.1    61.6    66.1    61.6\n2603          13   144.5   135.0   144.5   135.0\n"
        },
        {
            "inputData": "2409 BUY 23.35 7\n2609 BUY 113 1\n2409 SELL 22.55 10\n2303 BUY 60.6 54\n2603 SELL 140 7\n2498 SELL 77.2 3\n2498 BUY 82 1\n2609 SELL 110.5 7\n2409 SELL 22.15 3\n2498 BUY 77.4 6\n0050 BUY 143.5 7\n2409 SELL 22.15 1\n2409 BUY 22.6 2\n0050 SELL 143 9\n2609 SELL 111.5 9\n2303 SELL 63.9 4\n3481 BUY 19.35 90\n2603 SELL 136.5 9\n2303 BUY 64.4 6\n2330 BUY 632 1\n2303 SELL 58.6 2\n3481 SELL 19.35 2\n2330 SELL 612 6\n2498 SELL 80.4 2\n0050 SELL 142 10\n2603 BUY 140.5 8\n2409 BUY 22.55 3\n0050 BUY 146.5 1\n2609 BUY 113.5 10\n2603 BUY 142.5 3",
            "outputData": "stock_id  volumn    open   close    high     low\n2409          12   23.35   22.55   23.35   22.15\n2609          11   113.0   111.5   113.0   110.5\n2603          11   136.5   140.0   140.0   136.5\n0050           8   143.5   142.0   143.5   142.0\n2303           6    63.9    64.4    64.4    63.9\n2498           3    77.2    77.2    77.2    77.2\n3481           2   19.35   19.35   19.35   19.35\n2330           1     632     632     632     632\n"
        }
    ],
    "id": "rxUvZH-PDWOn"
}